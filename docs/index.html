<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Houston Kink Calendar</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    font-family: 'Inter', sans-serif;
    background: radial-gradient(circle at top, #1c1c1c, #0d0d0d 70%);
    color: #f2f2f2;
    display: flex;
    justify-content: center;
    min-height: 100vh;
}

.container {
    max-width: 900px;
    width: 100%;
    padding: 70px 20px 60px;
}

h1 {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 10px;
    letter-spacing: 1px;
}

.subtitle {
    color: #aaa;
    font-weight: 300;
    margin-bottom: 50px;
    font-size: 1.1rem;
}

.subscribe-grid {
    display: grid;
    gap: 20px;
    margin-bottom: 60px;
}

.sub-btn {
    display: block;
    text-align: center;
    padding: 18px;
    border-radius: 14px;
    text-decoration: none;
    font-weight: 600;
    font-size: 1.05rem;
    transition: all 0.25s ease;
    letter-spacing: 0.4px;
}

.sub-btn.apple {
    background: linear-gradient(135deg, #2e2e2e, #1a1a1a);
    border: 1px solid #444;
    color: white;
}

.sub-btn.google {
    background: linear-gradient(135deg, #1a73e8, #1558b0);
    color: white;
}

.sub-btn.outlook {
    background: linear-gradient(135deg, #0078d4, #005a9e);
    color: white;
}

.sub-btn:hover {
    transform: translateY(-4px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.45);
}

.section {
    background: rgba(255,255,255,0.05);
    border-radius: 14px;
    margin-bottom: 15px;
    overflow: hidden;
    transition: 0.3s ease;
}

.section-header {
    padding: 18px 20px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: 500;
}

.section-header:hover {
    background: rgba(255,255,255,0.08);
}

.section-content {
    max-height: 0;
    overflow: hidden;
    padding: 0 20px;
    transition: max-height 0.4s ease, padding 0.4s ease;
    color: #ccc;
    line-height: 1.6;
}

.section.active .section-content {
    max-height: 600px;
    padding: 20px;
}

code {
    background: rgba(255,255,255,0.08);
    padding: 4px 6px;
    border-radius: 6px;
    font-size: 0.9rem;
}

/* Card styling for the form + thanks */
.card {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 14px;
    padding: 22px;
    margin-top: 40px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.25);
}

.card h2 {
    margin: 0 0 10px 0;
    font-size: 1.4rem;
    letter-spacing: 0.2px;
}

.footer {
    margin-top: 70px;
    font-size: 0.85rem;
    color: #777;
    text-align: center;
    letter-spacing: 0.3px;
}

.form { display: grid; gap: 14px; margin-top: 10px; }
.field label { display:block; font-weight:600; margin-bottom:6px; }
.field input, .field textarea {
  width:100%;
  padding:12px 12px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.35);
  color: #fff;
  outline: none;
}
.field input:focus, .field textarea:focus { border-color: rgba(255,255,255,0.35); }
.hint { font-size: 12px; opacity: 0.75; margin-top: 6px; }

.two-col { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
@media (max-width: 720px) { .two-col { grid-template-columns: 1fr; } }

.segmented { display:flex; gap:10px; flex-wrap:wrap; }
.seg { display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:999px;
  border:1px solid rgba(255,255,255,0.12); background: rgba(0,0,0,0.25); cursor:pointer; }
.seg input { accent-color: #fff; }

.btn.primary {
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.18);
  background: rgba(255,255,255,0.12);
  color: #fff;
  font-weight: 700;
  cursor:pointer;
}
.btn.primary:hover { background: rgba(255,255,255,0.18); }

.muted { opacity: 0.8; }
.tiny { font-size: 12px; }

#formStatus {
  margin: 6px 0 0;
  font-size: 0.95rem;
}
</style>
</head>

<body>

<div class="container">

    <h1>Houston Kink Calendar</h1>
    <div class="subtitle">
        Live leather, pup, bear & community events across Houston.
        Subscribe once. Stay updated automatically.
    </div>

    <div class="subscribe-grid">

        <a class="sub-btn apple" href="webcal://daddybearrok.github.io/houstonkinkcal/houston-kink-cal.ics">
            üçé Subscribe on Mac / iPhone
        </a>

        <a class="sub-btn google" href="https://www.google.com/calendar/render?cid=https%3A%2F%2Fdaddybearrok.github.io%2Fhoustonkinkcal%2Fhouston-kink-cal.ics" target="_blank" rel="noopener">
            üìÖ Add to Google Calendar
        </a>

        <a class="sub-btn outlook" href="https://outlook.live.com/calendar/addfromweb?url=https://daddybearrok.github.io/houstonkinkcal/houston-kink-cal.ics&name=Houston%20Kink%20Cal&mkt=en-001" target="_blank" rel="noopener">
            üíº Add to Outlook
        </a>

    </div>

    <div class="section">
        <div class="section-header">
            üì± Manual Subscription Instructions
            <span>+</span>
        </div>
        <div class="section-content">
            <p>If the buttons above don‚Äôt work for your device, you can manually subscribe using this URL:</p>
            <p><code>https://daddybearrok.github.io/houstonkinkcal/houston-kink-cal.ics</code></p>
            <p>Add it using your calendar app‚Äôs ‚ÄúSubscribe from Web‚Äù or ‚ÄúAdd by URL‚Äù feature.</p>
        </div>
    </div>

    <div class="section">
        <div class="section-header">
            üîÅ Refresh & Updates
            <span>+</span>
        </div>
        <div class="section-content">
            <p>
                This is a live subscription calendar. Events update automatically.
                Some platforms (especially Google and Outlook) may take a few hours to refresh.
            </p>
            <p>
                Apple Calendar can be set to refresh hourly.
            </p>
        </div>
    </div>

    <!-- Submit Card -->
    <section class="card" id="submit">
      <h2>Submit an Event or Page</h2>
      <p class="muted">
        Got a Houston kink/leather/pup/bear/community event (or a Facebook page with events) that should be included?
        Drop it here. If it‚Äôs a good fit, I‚Äôll add it.
      </p>

      <form
        id="requestForm"
        action="https://formspree.io/f/xzdawajg"
        method="POST"
        class="form"
      >
        <!-- Honeypot -->
        <input type="text" name="_gotcha" style="display:none" autocomplete="off">

        <div class="field">
          <label>What are you submitting?</label>
          <div class="segmented">
            <label class="seg">
              <input type="radio" name="submission_type" value="single_event" checked>
              <span>Single Facebook Event</span>
            </label>
            <label class="seg">
              <input type="radio" name="submission_type" value="facebook_page">
              <span>Facebook Page with Events</span>
            </label>
          </div>
        </div>

        <div class="field">
          <label for="url">Facebook URL</label>
          <input
            id="url"
            name="facebook_url"
            type="url"
            placeholder="https://www.facebook.com/events/123...  OR  https://www.facebook.com/profile.php?id=..."
            required
          >
          <div class="hint">Tip: paste the full URL from your browser.</div>
        </div>

        <div class="field two-col">
          <div>
            <label for="name">Your name (optional)</label>
            <input id="name" name="submitter_name" type="text" placeholder="Name">
          </div>
          <div>
            <label for="email">Your email (optional)</label>
            <input id="email" name="submitter_email" type="email" placeholder="you@email.com">
          </div>
        </div>

        <div class="field">
          <label for="notes">Notes (optional)</label>
          <textarea
            id="notes"
            name="notes"
            rows="4"
            placeholder="Anything I should know? Frequency, venue, organizer, recurring events, etc."
          ></textarea>
        </div>

        <input type="hidden" name="_subject" value="Houston Kink Cal submission">

        <!-- IMPORTANT: repo pages path included -->
        <input type="hidden" name="_next" value="https://daddybearrok.github.io/houstonkinkcal/#thanks">

        <button type="submit" class="btn primary">Send Request</button>
        <p class="muted tiny">This sends an email request to the calendar admin. No guarantees, but I do review them.</p>
        <p id="formStatus" class="muted" aria-live="polite"></p>
      </form>
    </section>

    <!-- Thanks Card -->
    <section class="card" id="thanks" style="display:none;">
      <h2>Got it.</h2>
      <p class="muted">Thanks ‚Äî your submission was sent. If it‚Äôs a fit, it‚Äôll show up in the calendar soon.</p>
      <p class="muted tiny"><a href="#submit" style="color:#fff; opacity:.8; text-decoration:none;">Submit another</a></p>
    </section>

    <div class="footer">
        Built for the Houston community ‚Ä¢ Live ‚Ä¢ Automatic ‚Ä¢ Always evolving
    </div>

</div>

<script>
  // Expand/collapse sections
  document.querySelectorAll('.section-header').forEach(header => {
    header.addEventListener('click', () => {
      header.parentElement.classList.toggle('active');
    });
  });

  // If redirected back with #thanks, show thank-you and hide the form
  if (window.location.hash === "#thanks") {
    const thanks = document.getElementById("thanks");
    const submit = document.getElementById("submit");
    if (thanks) thanks.style.display = "block";
    if (submit) submit.style.display = "none";
  }

  // Optional: AJAX submit for a slick ‚Äúsending‚Ä¶‚Äù experience
  // This still works even if you keep _next; Formspree will accept JSON.
  const form = document.getElementById("requestForm");
  const statusEl = document.getElementById("formStatus");

  if (form && statusEl) {
    form.addEventListener("submit", async (e) => {
      // If JS fails, the normal POST + redirect still works.
      e.preventDefault();
      statusEl.textContent = "Sending‚Ä¶";

      try {
        const formData = new FormData(form);
        const res = await fetch(form.action, {
          method: "POST",
          body: formData,
          headers: { "Accept": "application/json" }
        });

        if (res.ok) {
          // Show thanks inline without relying on redirect
          document.getElementById("submit").style.display = "none";
          document.getElementById("thanks").style.display = "block";
          statusEl.textContent = "";
          form.reset();
          history.replaceState(null, "", "#thanks");
        } else {
          const data = await res.json().catch(() => null);
          statusEl.textContent = data?.error || "Something went wrong. Try again in a minute.";
        }
      } catch (err) {
        statusEl.textContent = "Network error. Try again in a minute.";
      }
    });
  }
</script>

</body>
</html>
